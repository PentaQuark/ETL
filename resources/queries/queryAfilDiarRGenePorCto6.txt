SELECT T.FECHA_DATO, to_char(T.FECHA_DATO, 'YYYYMM') as Añomes, SUM("Indefinido Tiempo completo") AS "Indefinido Tiempo completo", SUM("Indefinido Tiempo Parcial2") AS "Indefinido Tiempo Parcial2", SUM("Fijos Discontinuos") AS "Fijos Discontinuos", SUM("Eventual Tiempo Completo") AS "Eventual Tiempo Completo", SUM("Eventual Tiempo Parcial") AS "Eventual Tiempo Parcial", SUM("Aprendizaje, Formación y Prácticas") AS "Aprendizaje, Formación y Prácticas", SUM("OTROS") AS "OTROS", SUM("TOTAL") AS "TOTAL" FROM (select A0.FECHA_DATO, A0.valor as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A0 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B0 on A0.fecha_rept=B0.fecha_rept  and A0.FECHA_DATO=B0.FECHA_DATO  and A0.IdClasif=B0.IdClasif inner join afildiarrgeneporctoclasif6 as C0 on A0.IdClasif=C0.IdClasif  and C0.clasificacion='Indefinido Tiempo completo' UNION select A1.FECHA_DATO, 0 as "Indefinido Tiempo completo", A1.valor as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A1 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B1 on A1.fecha_rept=B1.fecha_rept  and A1.FECHA_DATO=B1.FECHA_DATO  and A1.IdClasif=B1.IdClasif inner join afildiarrgeneporctoclasif6 as C1 on A1.IdClasif=C1.IdClasif  and C1.clasificacion='Indefinido Tiempo Parcial2' UNION select A2.FECHA_DATO, 0 as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", A2.valor as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A2 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B2 on A2.fecha_rept=B2.fecha_rept  and A2.FECHA_DATO=B2.FECHA_DATO  and A2.IdClasif=B2.IdClasif inner join afildiarrgeneporctoclasif6 as C2 on A2.IdClasif=C2.IdClasif  and C2.clasificacion='Fijos Discontinuos' UNION select A3.FECHA_DATO, 0 as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", A3.valor as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A3 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B3 on A3.fecha_rept=B3.fecha_rept  and A3.FECHA_DATO=B3.FECHA_DATO  and A3.IdClasif=B3.IdClasif inner join afildiarrgeneporctoclasif6 as C3 on A3.IdClasif=C3.IdClasif  and C3.clasificacion='Eventual Tiempo Completo' UNION select A4.FECHA_DATO, 0 as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", A4.valor as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A4 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B4 on A4.fecha_rept=B4.fecha_rept  and A4.FECHA_DATO=B4.FECHA_DATO  and A4.IdClasif=B4.IdClasif inner join afildiarrgeneporctoclasif6 as C4 on A4.IdClasif=C4.IdClasif  and C4.clasificacion='Eventual Tiempo Parcial' UNION select A5.FECHA_DATO, 0 as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", A5.valor as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A5 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B5 on A5.fecha_rept=B5.fecha_rept  and A5.FECHA_DATO=B5.FECHA_DATO  and A5.IdClasif=B5.IdClasif inner join afildiarrgeneporctoclasif6 as C5 on A5.IdClasif=C5.IdClasif  and C5.clasificacion='Aprendizaje, Formación y Prácticas' UNION select A6.FECHA_DATO, 0 as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", A6.valor as "OTROS", 0 as "TOTAL" from AfilDiarRGenePorCto6 as A6 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B6 on A6.fecha_rept=B6.fecha_rept  and A6.FECHA_DATO=B6.FECHA_DATO  and A6.IdClasif=B6.IdClasif inner join afildiarrgeneporctoclasif6 as C6 on A6.IdClasif=C6.IdClasif  and C6.clasificacion='OTROS' UNION select A7.FECHA_DATO, 0 as "Indefinido Tiempo completo", 0 as "Indefinido Tiempo Parcial2", 0 as "Fijos Discontinuos", 0 as "Eventual Tiempo Completo", 0 as "Eventual Tiempo Parcial", 0 as "Aprendizaje, Formación y Prácticas", 0 as "OTROS", A7.valor as "TOTAL" from AfilDiarRGenePorCto6 as A7 inner join (select FECHA_DATO, IdClasif, max(fecha_rept) as fecha_rept from afildiarrgeneporcto6 group by FECHA_DATO, IdClasif) as B7 on A7.fecha_rept=B7.fecha_rept  and A7.FECHA_DATO=B7.FECHA_DATO  and A7.IdClasif=B7.IdClasif inner join afildiarrgeneporctoclasif6 as C7 on A7.IdClasif=C7.IdClasif  and C7.clasificacion='TOTAL' ) AS T GROUP BY T.FECHA_DATO ORDER BY T.FECHA_DATO 