drop view if exists VISTA_5afildiarportipo ; CREATE VIEW VISTA_5afildiarportipo as SELECT T.FECHA_DATO, SUM("GENERAL") AS "GENERAL", SUM("S.E.Agrario") AS "S.E.Agrario", SUM("S.E.Hogar") AS "S.E.Hogar", SUM("RETA") AS "RETA", SUM("No SETA") AS "No SETA", SUM("SETA") AS "SETA", SUM("Mar ajena") AS "Mar ajena", SUM("Mar propia") AS "Mar propia", SUM("Carbón") AS "Carbón", SUM("Agricultura") AS "Agricultura", SUM("Industria") AS "Industria", SUM("Construcción") AS "Construcción", SUM("Servicios") AS "Servicios", SUM("TOTALSISTEMA") AS "TOTALSISTEMA" FROM (select A0.FECHA_DATO, A0.valor as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A0 inner join afildiartipos5 as C0 on A0.idtipo=C0.idtipo  and C0.tipo='GENERAL' UNION select A1.FECHA_DATO, 0 as "GENERAL", A1.valor as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A1 inner join afildiartipos5 as C1 on A1.idtipo=C1.idtipo  and C1.tipo='S.E.Agrario' UNION select A2.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", A2.valor as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A2 inner join afildiartipos5 as C2 on A2.idtipo=C2.idtipo  and C2.tipo='S.E.Hogar' UNION select A3.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", A3.valor as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A3 inner join afildiartipos5 as C3 on A3.idtipo=C3.idtipo  and C3.tipo='RETA' UNION select A4.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", A4.valor as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A4 inner join afildiartipos5 as C4 on A4.idtipo=C4.idtipo  and C4.tipo='No SETA' UNION select A5.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", A5.valor as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A5 inner join afildiartipos5 as C5 on A5.idtipo=C5.idtipo  and C5.tipo='SETA' UNION select A6.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", A6.valor as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A6 inner join afildiartipos5 as C6 on A6.idtipo=C6.idtipo  and C6.tipo='Mar ajena' UNION select A7.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", A7.valor as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A7 inner join afildiartipos5 as C7 on A7.idtipo=C7.idtipo  and C7.tipo='Mar propia' UNION select A8.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", A8.valor as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A8 inner join afildiartipos5 as C8 on A8.idtipo=C8.idtipo  and C8.tipo='Carbón' UNION select A9.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", A9.valor as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A9 inner join afildiartipos5 as C9 on A9.idtipo=C9.idtipo  and C9.tipo='Agricultura' UNION select A10.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", A10.valor as "Industria", 0 as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A10 inner join afildiartipos5 as C10 on A10.idtipo=C10.idtipo  and C10.tipo='Industria' UNION select A11.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", A11.valor as "Construcción", 0 as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A11 inner join afildiartipos5 as C11 on A11.idtipo=C11.idtipo  and C11.tipo='Construcción' UNION select A12.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", A12.valor as "Servicios", 0 as "TOTALSISTEMA" from AfilDiarPorTipo5 as A12 inner join afildiartipos5 as C12 on A12.idtipo=C12.idtipo  and C12.tipo='Servicios' UNION select A13.FECHA_DATO, 0 as "GENERAL", 0 as "S.E.Agrario", 0 as "S.E.Hogar", 0 as "RETA", 0 as "No SETA", 0 as "SETA", 0 as "Mar ajena", 0 as "Mar propia", 0 as "Carbón", 0 as "Agricultura", 0 as "Industria", 0 as "Construcción", 0 as "Servicios", A13.valor as "TOTALSISTEMA" from AfilDiarPorTipo5 as A13 inner join afildiartipos5 as C13 on A13.idtipo=C13.idtipo  and C13.tipo='TOTALSISTEMA' ) AS T GROUP BY T.FECHA_DATO ORDER BY T.FECHA_DATO 